# IO.net Enhanced Somnia Gas Profiler - Examples\n\nThis document provides comprehensive examples for using the enhanced Somnia Gas Profiler with different input types and scenarios.\n\n## 📋 Table of Contents\n\n1. [Deployed Contract Analysis](#deployed-contract-analysis)\n2. [Bytecode Profiling](#bytecode-profiling)\n3. [Source Code Compilation](#source-code-compilation)\n4. [Quick Analysis Scenarios](#quick-analysis-scenarios)\n5. [Advanced Workflows](#advanced-workflows)\n6. [Comparison Analysis](#comparison-analysis)\n7. [Cost Analysis Examples](#cost-analysis-examples)\n8. [CI/CD Integration](#cicd-integration)\n\n## 🌐 Deployed Contract Analysis\n\n### Example 1: ERC20 Token Analysis\n\n```bash\n# Quick analysis with standard ERC20 ABI\nsomnia-gas-profiler quick-analyze \\\n  --address 0x742d35Cc6634C0532925a3b8D6c6C0c1f528d15 \\\n  --standard ERC20 \\\n  --runs 5\n```\n\n**Output:**\n```\n⚡ Starting quick contract analysis...\n\n🌐 Connected to: https://dream-rpc.somnia.network\n📍 Analyzing contract: 0x742d35Cc6634C0532925a3b8D6c6C0c1f528d15\n\n✅ Contract found on network\n   Bytecode length: 12847 characters\n\n✅ Using ERC20 standard ABI\n\n📋 Contract Analysis\n─────────────────────────────────────\nType: ERC20\nComplexity: moderate\nTotal Functions: 6\n  - View/Pure: 3\n  - State-changing: 3\nEvents: 2\nBytecode: 6423 bytes\n\n⚡ Profiling 6 functions...\n\n📊 Somnia Gas Profiling Report\n─────────────────────────────────────\n🌐 Network: Somnia Testnet\n📋 Contract: 0x742d35Cc6634C0532925a3b8D6c6C0c1f528d15\n\n┌─────────────────────────┬──────┬─────────┬─────────┬─────────┬───────────┬──────────────┐\n│ Function                │ Runs │ Min Gas │ Max Gas │ Avg Gas │ Total Gas │ Avg Cost(STT)│\n├─────────────────────────┼──────┼─────────┼─────────┼─────────┼───────────┼──────────────┤\n│ transfer(address,uint256)│ 5    │ 51,123  │ 51,567  │ 51,245  │ 256,225   │ 0.00030747   │\n│ approve(address,uint256) │ 5    │ 46,234  │ 46,789  │ 46,512  │ 232,560   │ 0.00027907   │\n│ transferFrom(address,...)│ 5    │ 61,890  │ 62,345  │ 62,123  │ 310,615   │ 0.00037274   │\n│ balanceOf(address)      │ 5    │ 2,334   │ 2,334   │ 2,334   │ 11,670    │ 0.00001400   │\n│ allowance(address,addr..)│ 5    │ 2,456   │ 2,456   │ 2,456   │ 12,280    │ 0.00001473   │\n│ totalSupply()           │ 5    │ 2,123   │ 2,123   │ 2,123   │ 10,615    │ 0.00001274   │\n└─────────────────────────┴──────┴─────────┴─────────┴─────────┴───────────┴──────────────┘\n\n🧠 AI Analysis Summary\n─────────────────────────────────────────────────────────\nThis ERC20 token contract demonstrates excellent gas efficiency \nwith consistent performance patterns. The transferFrom function \nshows the highest gas usage due to additional allowance checks, \nwhile view functions are optimally implemented...\n\n⚡ Quick analysis complete!\n```\n\n### Example 2: Custom Contract with Explicit ABI\n\n```bash\n# Analysis with custom ABI file\nsomnia-gas-profiler profile \\\n  --address 0x9876543210987654321098765432109876543210 \\\n  --abi ./contracts/CustomProtocol.json \\\n  --runs 3 \\\n  --output custom_analysis.json\n```\n\n### Example 3: NFT Contract Analysis\n\n```bash\n# ERC721 analysis focusing on minting functions\nsomnia-gas-profiler quick-analyze \\\n  --address 0x1111222233334444555566667777888899990000 \\\n  --standard ERC721 \\\n  --functions \"mint(address,uint256)\" \"safeTransferFrom(address,address,uint256)\" \\\n  --runs 7\n```\n\n## 🔧 Bytecode Profiling\n\n### Example 4: Direct Bytecode Analysis\n\n```bash\n# Profile contract from bytecode with ABI\nsomnia-gas-profiler profile \\\n  --bytecode 0x608060405234801561001057600080fd5b50336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506040518060400160405280600d81526020017f48656c6c6f2c20576f726c64210000000000000000000000000000000000000081525060019080519060200190610096929190610140565b50610244565b6101a2806100b16000396000f3fe... \\\n  --abi '[{\"inputs\":[],\"name\":\"getMessage\",\"outputs\":[{\"type\":\"string\"}],\"stateMutability\":\"view\",\"type\":\"function\"}]' \\\n  --verbose\n```\n\n**Expected Output:**\n```\n🚀 Starting enhanced gas profiling...\n\n📝 Processing raw bytecode...\n   Bytecode length: 1456 characters\n\n🚀 Deploying contract to Somnia testnet...\n✅ Contract deployed at: 0xabcd1234567890abcdef1234567890abcdef1234\n\n✅ Contract loaded: 0xabcd1234567890abcdef1234567890abcdef1234\n   Source: bytecode\n   Functions: 1\n\n🔍 Detected contract type: Custom\n\n⚡ Running gas profiling...\n\nFunction: getMessage()\nRun 1: 2,234 gas | 0.00001340 STT\nRun 2: 2,234 gas | 0.00001340 STT\nRun 3: 2,234 gas | 0.00001340 STT\n\n📊 Generating CSV report...\n✅ CSV report saved: profiling_1692998765.csv\n\n🤖 Generating AI analysis...\n🧠 AI Gas Analysis Summary\n─────────────────────────────────────────────────────────\nThis simple contract shows excellent efficiency for view \nfunctions. The getMessage function demonstrates optimal \nstorage access patterns with zero gas variance...\n```\n\n### Example 5: Bytecode with Auto-ABI Generation\n\n```bash\n# Let the profiler generate minimal ABI from bytecode\nsomnia-gas-profiler profile \\\n  --bytecode 0x6080604052348015610010... \\\n  --runs 2\n```\n\n## 📝 Source Code Compilation\n\n### Example 6: Simple Contract Compilation\n\n```bash\n# Compile and profile a simple storage contract\nsomnia-gas-profiler compile-and-profile \\\n  --source ./contracts/SimpleStorage.sol \\\n  --optimization-runs 200\n```\n\n**SimpleStorage.sol:**\n```\n// SPDX-License-Identifier: MIT\npragma solidity ^0.8.19;\n\ncontract SimpleStorage {\n    uint256 private value;\n    \n    function set(uint256 _value) public {\n        value = _value;\n    }\n    \n    function get() public view returns (uint256) {\n        return value;\n    }\n    \n    function increment() public {\n        value++;\n    }\n}\n```\n\n### Example 7: Optimization Comparison\n\n```bash\n# Test different optimization levels\nsomnia-gas-profiler compile-and-profile \\\n  --source ./contracts/ComplexContract.sol \\\n  --optimization-runs 0 \\\n  --output no_optimization.json\n\nsomnia-gas-profiler compile-and-profile \\\n  --source ./contracts/ComplexContract.sol \\\n  --optimization-runs 200 \\\n  --output standard_optimization.json\n\nsomnia-gas-profiler compile-and-profile \\\n  --source ./contracts/ComplexContract.sol \\\n  --optimization-runs 10000 \\\n  --output high_optimization.json\n\n# Compare results\nsomnia-gas-profiler report \\\n  --in no_optimization.json \\\n  --compare standard_optimization.json\n```\n\n### Example 8: Inline Contract Code\n\n```bash\n# Profile inline Solidity code\nsomnia-gas-profiler compile-and-profile \\\n  --code 'contract Calculator { \n    function add(uint256 a, uint256 b) public pure returns (uint256) { \n      return a + b; \n    } \n    function multiply(uint256 a, uint256 b) public pure returns (uint256) { \n      return a * b; \n    } \n  }' \\\n  --contract-name Calculator \\\n  --runs 5\n```\n\n### Example 9: Advanced Compilation Options\n\n```bash\n# Compile with IR and latest Solidity version\nsomnia-gas-profiler compile-and-profile \\\n  --source ./contracts/AdvancedDeFi.sol \\\n  --via-ir \\\n  --solc-version 0.8.21 \\\n  --optimization-runs 1000 \\\n  --runs 10 \\\n  --output advanced_defi_analysis.json\n```\n\n## ⚡ Quick Analysis Scenarios\n\n### Example 10: Ultra-Fast Development Check\n\n```bash\n# Quick check during development\nsomnia-gas-profiler quick-analyze \\\n  --address 0x123... \\\n  --quick \\\n  --skip-ai \\\n  --max-functions 3\n```\n\n### Example 11: View Functions Only\n\n```bash\n# Profile only read operations\nsomnia-gas-profiler quick-analyze \\\n  --address 0x456... \\\n  --view-only \\\n  --abi ./readonly-abi.json\n```\n\n### Example 12: State-Changing Functions Focus\n\n```bash\n# Focus on expensive state changes\nsomnia-gas-profiler quick-analyze \\\n  --address 0x789... \\\n  --state-only \\\n  --runs 10 \\\n  --gasless\n```\n\n## 🔄 Advanced Workflows\n\n### Example 13: Complete Development Cycle\n\n``bash\n#!/bin/bash\n# Complete gas analysis workflow\n\necho \"Step 1: Initial compilation and profiling\"\nsomnia-gas-profiler compile-and-profile \\\n  --source ./MyToken.sol \\\n  --output initial_analysis.json\n\necho \"Step 2: Optimized compilation\"\nsomnia-gas-profiler compile-and-profile \\\n  --source ./MyToken.sol \\\n  --optimization-runs 1000 \\\n  --output optimized_analysis.json\n\necho \"Step 3: Comparison analysis\"\nsomnia-gas-profiler report \\\n  --in initial_analysis.json \\\n  --compare optimized_analysis.json \\\n  --format csv \\\n  --out comparison_report.csv\n\necho \"Step 4: AI-powered optimization suggestions\"\nsomnia-gas-profiler report \\\n  --in optimized_analysis.json \\\n  --nl\n\necho \"Analysis complete! Check comparison_report.csv for details.\"\n```\n\n### Example 14: Multi-Contract Analysis\n\n``bash\n# Analyze multiple related contracts\nfor contract in Token Staking Rewards; do\n  echo \"Analyzing $contract...\"\n  somnia-gas-profiler compile-and-profile \\\n    --source ./contracts/$contract.sol \\\n    --output ${contract,,}_analysis.json\ndone\n\n# Generate combined report\nsomnia-gas-profiler report --in token_analysis.json --format table\nsomnia-gas-profiler report --in staking_analysis.json --format table  \nsomnia-gas-profiler report --in rewards_analysis.json --format table\n```\n\n## 📊 Comparison Analysis\n\n### Example 15: Before/After Optimization\n\n```bash\n# Profile before optimization\nsomnia-gas-profiler profile \\\n  --address 0xBEFORE... \\\n  --abi ./before.json \\\n  --output before_optimization.json\n\n# Profile after optimization  \nsomnia-gas-profiler profile \\\n  --address 0xAFTER... \\\n  --abi ./after.json \\\n  --output after_optimization.json\n\n# Generate comparison\nsomnia-gas-profiler report \\\n  --in before_optimization.json \\\n  --compare after_optimization.json\n```\n\n**Expected Comparison Output:**\n```\n🔍 Gas Profiling Comparison Report\n═══════════════════════════════════════\n📊 File 1: before_optimization.json (2025-08-25 22:30:15)\n📊 File 2: after_optimization.json (2025-08-25 22:35:20)\n\n┌─────────────────────────┬─────────────┬──────────┬──────────┬──────────┐\n│ Function                │ Avg Gas Diff│ Change % │ Min Diff │ Max Diff │\n├─────────────────────────┼─────────────┼──────────┼──────────┼──────────┤\n│ transfer(address,uint256)│ -2,345      │ -3.65%   │ -2,400   │ -2,290   │\n│ approve(address,uint256) │ -1,890      │ -4.02%   │ -1,920   │ -1,860   │\n│ mint(address,uint256)    │ -5,670      │ -8.23%   │ -5,700   │ -5,640   │\n└─────────────────────────┴─────────────┴──────────┴──────────┴──────────┘\n\n💡 Green = Gas savings, Red = Gas increase\n```\n\n### Example 16: Solidity Version Comparison\n\n```bash\n# Test different Solidity versions\nsomnia-gas-profiler compile-and-profile \\\n  --source ./Contract.sol \\\n  --solc-version 0.8.19 \\\n  --output solc_0819.json\n\nsomnia-gas-profiler compile-and-profile \\\n  --source ./Contract.sol \\\n  --solc-version 0.8.21 \\\n  --output solc_0821.json\n\nsomnia-gas-profiler report \\\n  --in solc_0819.json \\\n  --compare solc_0821.json\n```\n\n## 💰 Cost Analysis Examples\n\n### Example 17: Production Cost Estimation\n\n```bash\n# Analyze production costs with high iteration count\nsomnia-gas-profiler profile \\\n  --address 0xPRODUCTION... \\\n  --abi ./production.json \\\n  --runs 20 \\\n  --output production_costs.json\n\n# Generate cost-focused report\nsomnia-gas-profiler report \\\n  --in production_costs.json \\\n  --format csv \\\n  --out production_cost_analysis.csv\n```\n\n### Example 18: User Interaction Cost Modeling\n\n```bash\n# Focus on user-facing functions\nsomnia-gas-profiler quick-analyze \\\n  --address 0xDAPP... \\\n  --functions \"stake(uint256)\" \"unstake(uint256)\" \"claimRewards()\" \\\n  --runs 15 \\\n  --output user_interaction_costs.json\n```\n\n## 🔄 CI/CD Integration\n\n### Example 19: GitHub Actions Workflow\n\n```yaml\n# .github/workflows/gas-analysis.yml\nname: Gas Analysis\n\non:\n  pull_request:\n    paths:\n      - 'contracts/**'\n      \njobs:\n  gas-analysis:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      \n      - name: Setup Node.js\n        uses: actions/setup-node@v3\n        with:\n          node-version: '18'\n          \n      - name: Install dependencies\n        run: |\n          npm install -g somnia-gas-profiler\n          npm install\n          \n      - name: Analyze gas usage\n        env:\n          PRIVATE_KEY: ${{ secrets.TEST_PRIVATE_KEY }}\n          IOINTELLIGENCE_API_KEY: ${{ secrets.IO_NET_API_KEY }}\n        run: |\n          # Analyze all contracts\n          for contract in contracts/*.sol; do\n            echo \"Analyzing $contract\"\n            somnia-gas-profiler compile-and-profile \\\n              --source \"$contract\" \\\n              --output \"gas_analysis_$(basename $contract .sol).json\"\n          done\n          \n      - name: Generate reports\n        run: |\n          # Generate CSV reports\n          for result in gas_analysis_*.json; do\n            somnia-gas-profiler report \\\n              --in \"$result\" \\\n              --format csv \\\n              --out \"${result%.json}.csv\"\n          done\n          \n      - name: Upload results\n        uses: actions/upload-artifact@v3\n        with:\n          name: gas-analysis-results\n          path: |\n            gas_analysis_*.json\n            gas_analysis_*.csv\n```\n\n### Example 20: Regression Testing\n\n``bash\n#!/bin/bash\n# Gas regression test script\n\nset -e\n\nBASELINE_DIR=\"./baseline_gas\"\nCURRENT_DIR=\"./current_gas\"\n\necho \"Running gas regression tests...\"\n\n# Analyze current contracts\nmkdir -p \"$CURRENT_DIR\"\nfor contract in contracts/*.sol; do\n  name=$(basename \"$contract\" .sol)\n  echo \"Analyzing $name...\"\n  \n  somnia-gas-profiler compile-and-profile \\\n    --source \"$contract\" \\\n    --optimization-runs 200 \\\n    --output \"$CURRENT_DIR/${name}_gas.json\"\ndone\n\n# Compare with baseline if exists\nif [ -d \"$BASELINE_DIR\" ]; then\n  echo \"Comparing with baseline...\"\n  \n  for current in \"$CURRENT_DIR\"/*.json; do\n    name=$(basename \"$current\")\n    baseline=\"$BASELINE_DIR/$name\"\n    \n    if [ -f \"$baseline\" ]; then\n      echo \"Comparing $name...\"\n      \n      somnia-gas-profiler report \\\n        --in \"$baseline\" \\\n        --compare \"$current\" \\\n        --format csv \\\n        --out \"regression_${name%.json}.csv\"\n    fi\n  done\nelse\n  echo \"No baseline found. Current results will become baseline.\"\n  cp -r \"$CURRENT_DIR\" \"$BASELINE_DIR\"\nfi\n\necho \"Gas analysis complete!\"\n```\n\n## 🎯 Performance Optimization Examples\n\n### Example 21: Gas-Optimized Contract Testing\n\n```solidity\n// contracts/OptimizedToken.sol\npragma solidity ^0.8.19;\n\ncontract OptimizedToken {\n    mapping(address => uint256) private _balances;\n    mapping(address => mapping(address => uint256)) private _allowances;\n    \n    uint256 private _totalSupply;\n    \n    // Gas-optimized transfer\n    function transfer(address to, uint256 amount) external returns (bool) {\n        address owner = msg.sender;\n        _transfer(owner, to, amount);\n        return true;\n    }\n    \n    // Batch transfer for gas efficiency\n    function batchTransfer(address[] calldata recipients, uint256[] calldata amounts) \n        external \n        returns (bool) \n    {\n        require(recipients.length == amounts.length, \"Array length mismatch\");\n        \n        address owner = msg.sender;\n        for (uint256 i = 0; i < recipients.length;) {\n            _transfer(owner, recipients[i], amounts[i]);\n            unchecked { ++i; }\n        }\n        return true;\n    }\n    \n    function _transfer(address from, address to, uint256 amount) internal {\n        require(from != address(0), \"Transfer from zero address\");\n        require(to != address(0), \"Transfer to zero address\");\n        \n        uint256 fromBalance = _balances[from];\n        require(fromBalance >= amount, \"Insufficient balance\");\n        \n        unchecked {\n            _balances[from] = fromBalance - amount;\n            _balances[to] += amount;\n        }\n    }\n}\n```\n\n```bash\n# Test optimized vs standard implementation\nsomnia-gas-profiler compile-and-profile \\\n  --source ./contracts/OptimizedToken.sol \\\n  --optimization-runs 10000 \\\n  --output optimized_token.json\n\n# Compare single vs batch transfers\nsomnia-gas-profiler profile \\\n  --address 0xOPTIMIZED... \\\n  --abi ./optimized_abi.json \\\n  --functions \"transfer(address,uint256)\" \"batchTransfer(address[],uint256[])\" \\\n  --runs 10\n```\n\n---\n\n*These examples demonstrate the full capabilities of the IO.net Enhanced Somnia Gas Profiler. For more information, see [USAGE.md](./USAGE.md) and the [official documentation](https://docs.somnia.network/).*", "original_text": "", "replace_all": false}]
```

```
